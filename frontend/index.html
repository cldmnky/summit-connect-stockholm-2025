<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stockholm Datacenters Map</title>
    <link rel="stylesheet" href="https://unpkg.com/@patternfly/patternfly@6/patternfly.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
</head>

<body>
    <div class="pf-v6-c-page">
        <div class="pf-v6-c-page__main-section">
            <header class="pf-v6-c-page__main-section pf-m-light">
                <div class="pf-v6-c-content">
                    <h1 class="pf-v6-c-title pf-m-3xl">Stockholm County Datacenters</h1>
                    <p class="pf-v6-c-content">Interactive map showing datacenter locations and VM distribution</p>
                </div>
            </header>

            <main class="pf-v6-c-page__main-section pf-m-fill">
                <div class="pf-v6-l-grid pf-m-gutter openshift-layout">
                    <!-- Main content area -->
                    <div class="pf-v6-l-grid__item pf-m-8-col-on-lg pf-m-12-col-on-md">
                        <div class="pf-v6-c-card map-container">
                            <div class="pf-v6-c-card__title">
                                <h2 class="pf-v6-c-title pf-m-lg">Datacenter Topology</h2>
                            </div>
                            <div class="pf-v6-c-card__body">
                                <div id="map"></div>
                                <div class="legend">
                                    <div class="legend-item">
                                        <div class="legend-symbol datacenter"></div>
                                        <span>Datacenter</span>
                                    </div>
                                    <div class="legend-item">
                                        <div class="legend-symbol vm-indicator"></div>
                                        <span>VM Activity</span>
                                    </div>
                                </div>
                                <div class="map-controls">
                                    <button id="toggle-satellite" class="pf-v6-c-button pf-m-secondary pf-m-small">Street View</button>
                                    <button id="center-map" class="pf-v6-c-button pf-m-secondary pf-m-small">Center Map</button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Active Migrations Panel - Moved below map, always expanded -->
                        <div class="pf-v6-c-card panel-card migrations-below-map">
                            <div class="pf-v6-c-card__header">
                                <div class="pf-v6-c-card__header-main">
                                    <div class="title-with-count">
                                        <h3 class="pf-v6-c-card__title">Migrations</h3>
                                        <span class="count-badge" id="migration-count-badge">0</span>
                                    </div>
                                </div>
                            </div>
                            <div class="pf-v6-c-card__body"
                                <div class="filter-section">
                                    <div class="filter-controls">
                                        <div class="filter-group">
                                            <label class="pf-v6-c-form__label">Show:</label>
                                            <select id="migration-filter-mode" class="pf-v6-c-form-control pf-m-small">
                                                <option value="active">Active Only</option>
                                                <option value="all">All Migrations</option>
                                                <option value="completed">Completed</option>
                                            </select>
                                        </div>
                                        <button id="refresh-migrations" class="pf-v6-c-button pf-m-link pf-m-small">
                                            <i class="fas fa-sync-alt" aria-hidden="true"></i>
                                            Refresh
                                        </button>
                                    </div>
                                </div>
                                <div class="content-section">
                                    <div class="migration-list-rows" id="migration-list-rows">
                                        <!-- Migration rows populated by app.js -->
                                        <div class="empty-state">
                                            <p class="pf-v6-c-content">No active migrations</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Sidebar panels -->
                    <div class="pf-v6-l-grid__item pf-m-4-col-on-lg pf-m-12-col-on-md">
                        <div class="sidebar-panels">
                            <!-- Datacenter Overview Panel (right overlay) -->
                            <div class="pf-v6-c-card panel-card right-overlay" id="datacenter-overview-panel">
                                <div class="pf-v6-c-card__header collapsible-header" data-target="datacenter-overview">
                                    <div class="collapsible-title">
                                        <div class="pf-v6-c-card__header-main">
                                            <h3 class="pf-v6-c-card__title">Datacenter Overview</h3>
                                        </div>
                                        <div class="pf-v6-c-card__actions">
                                            <button class="collapse-toggle pf-v6-c-button pf-m-plain" aria-label="Toggle datacenter overview">
                                                <i class="fas fa-chevron-down" aria-hidden="true"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div class="pf-v6-c-card__body collapsible-content datacenter-view" id="datacenter-view" data-section="datacenter-overview">
                                    <!-- Datacenter details will be populated here -->
                                </div>
                            </div>

                            <!-- Active VMs Panel (right overlay) -->
                            <div class="pf-v6-c-card panel-card right-overlay" id="active-vms-panel">
                                <div class="pf-v6-c-card__header collapsible-header" data-target="active-vms">
                                    <div class="collapsible-title">
                                        <div class="pf-v6-c-card__header-main">
                                            <div class="title-with-count">
                                                <h3 class="pf-v6-c-card__title">Active VMs</h3>
                                                <span class="count-badge" id="vm-count-badge">0</span>
                                            </div>
                                        </div>
                                        <div class="pf-v6-c-card__actions">
                                            <button class="collapse-toggle pf-v6-c-button pf-m-plain" aria-label="Toggle active VMs">
                                                <i class="fas fa-chevron-down" aria-hidden="true"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div class="pf-v6-c-card__body collapsible-content" data-section="active-vms">
                                    <div class="filter-section">
                                        <div class="filter-controls">
                                            <div class="filter-group">
                                                <label class="pf-v6-c-form__label">Show:</label>
                                                <select id="vm-filter-mode" class="pf-v6-c-form-control pf-m-small">
                                                    <option value="all">All VMs</option>
                                                    <option value="migrating">Only Migrating</option>
                                                </select>
                                            </div>
                                            <div class="pf-v6-c-check">
                                                <input type="checkbox" id="vm-hide-inactive" class="pf-v6-c-check__input" checked /> 
                                                <label for="vm-hide-inactive" class="pf-v6-c-check__label">Hide inactive</label>
                                            </div>
                                        </div>
                                        <div class="search-controls">
                                            <div class="pf-v6-c-form__group">
                                                <input type="text" id="vm-name-filter" class="pf-v6-c-form-control" placeholder="Filter by VM name..." />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="content-section">
                                        <div class="vm-list-rows" id="vm-list-rows">
                                            <!-- VM rows populated by app.js -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <div class="tooltip" id="tooltip"></div>
    <div id="toast" class="toast" aria-live="polite" role="status" style="display:none"></div>

    <script src="app.js"></script>
</body>

</html>